#include<stdio.h>
#include<stdlib.h>

int FindRootCompress(int* parent, int ele)
{
    if (parent[ele] == ele) {
        return ele;
    }
    parent[ele] = FindRootCompress(parent, parent[ele]);
    return parent[ele];
}
int MergeElementByRank(int* parent, int* rank, int x, int y)
{
    int xRoot, yRoot;
    xRoot = FindRootCompress(parent, x);
    yRoot = FindRootCompress(parent, y);
    if (xRoot == yRoot) {
        return 0;
    }
    if (rank[xRoot] > rank[yRoot]) {
        parent[yRoot] = xRoot;
    }
    if (rank[xRoot] < rank[yRoot]) {
        parent[xRoot] = yRoot;
    }
    if (rank[xRoot] == rank[yRoot]) {
        parent[yRoot] = xRoot;
        rank[xRoot]++;
    }
    return 1;
}
int removeStones(int** stones, int stonesSize, int* stonesColSize){

   int* parent = NULL;
   int* rank = NULL;
   int count = 0;
   int i, j;
   int xTemp, yTemp;
    parent = (int*)calloc(stonesSize, sizeof(int));
    rank = (int*)calloc(stonesSize, sizeof(int));
    for (i = 0; i < stonesSize; i++) {
            parent[i] = i;
            rank[i] = 1;
    }
    // 合并同行元素同列的石头序号
    for (i = 0; i < stonesSize; i++) {
        for (j = i; j < stonesSize; j++) {
            if (stones[i][0] == stones[j][0] || stones[i][1] == stones[j][1]) {
                MergeElementByRank(parent, rank, i, j);
            }
        }
    }
    for (i = 0; i < stonesSize; i++) {
        if (parent[i] == i) {
            count++;
        }
    }
    free(parent);
    free(rank);
    // 可移除的次数为 石头数 - 集合数    （因为假设10个石头，集合1中4个， 集合2中1个，其实只能移////走 3个；另一层面
    //是10 - 5 -集合1 - 集合2 = 3）
    return stonesSize - count;
}
int main()
{
    int tmpStone[][2] = {
/*{0,0},
{0,1},
{1,0},
{1,2},
{2,1},
{2,2},*/
{2182,8179},
{6950,4772},
{4813,7951},
{717,2394},
{8418,6157},
{7711,2515},
{4279,1381},
{5077,6524},
{1067,329},
{3386,6366},
{7670,5324},
{5454,9219},
{7924,3404},
{1887,8655},
{8652,16},
{7931,7560},
{6995,2721},
{8442,3660},
{6679,6181},
{1073,8517},
{1909,3188},
{9351,797},
{785,2602},
{7481,2042},
{8321,3244},
{9585,2676},
{1941,995},
{2174,5887},
{6849,5626},
{5836,3449},
{4957,1981},
{5287,2169},
{4994,1036},
{9392,1491},
{561,1006},
{3582,2924},
{4040,6136},
{553,3446},
{3935,81},
{6688,3526},
{7585,840},
{7624,690},
{4836,6046},
{4641,6797},
{5037,9103},
{9684,1024},
{2597,1679},
{9528,7316},
{9192,9804},
{3397,6093},
{8370,7965},
{6501,457},
{8951,470},
{2085,8783},
{9066,8776},
{9824,507},
{8652,5492},
{1413,1291},
{2655,4561},
{5340,7151},
{635,9380},
{4235,7758},
{1788,3910},
{710,6304},
{2726,7203},
{1217,3718},
{492,6844},
{4125,4565},
{5282,6186},
{7056,576},
{2491,1444},
{2986,9953},
{3412,2852},
{5061,4702},
{2232,264},
{8231,5664},
{7376,8511},
{5010,4697},
{9601,8837},
{5767,8569},
{4703,5677},
{7244,7723},
{9696,1672},
{4881,8882},
{437,5109},
{6313,4899},
{3003,9894},
{1470,6768},
{6572,8348},
{4143,6224},
{5461,7539},
{946,7949},
{7874,8339},
{5749,704},
{9653,1512},
{2631,7196},
{9911,9702},
{5410,7165},
{109,87},
{8689,874},
{2710,5420},
{2019,5035},
{4150,9523},
{7624,9064},
{8572,273},
{2115,7640},
{5341,8049},
{5791,9449},
{8147,2788},
{7140,7515},
{1809,9059},
{4492,5355},
{6060,2525},
{290,7640},
{7158,4451},
{5518,8699},
{6316,4479},
{4576,1845},
{4556,8744},
{2720,9466},
{7814,5761},
{1478,8927},
{927,3770},
{6394,1393},
{7018,4099},
{4684,1352},
{1750,5335},
{7040,9177},
{7967,6821},
{302,6968},
{6856,4660},
{4943,4826},
{1909,3406},
{6887,2517},
{2407,6398},
{4207,2800},
{5160,3982},
{8305,8552},
{8075,959},
{9620,2591},
{7566,9511},
{8730,4617},
{8623,9308},
{7221,6175},
{4642,3999},
{1228,2328},
{4522,8628},
{3989,6450},
{2612,9261},
{7281,5235},
{8143,2179},
{3462,7521},
{6506,7674},
{4484,468},
{5200,9513},
{542,5110},
{2712,5908},
{6859,859},
{5470,8222},
{4815,3728},
{9417,2074},
{5096,610},
{3627,6533},
{2078,1875},
{3992,5581},
{3804,2254},
{1641,2150},
{8590,4694},
{9534,681},
{7768,398},
{1946,4219},
{7390,8084},
{9357,4699},
{5333,1016},
{3292,7307},
{1937,8896},
{1651,3089},
{1548,4345},
{4351,6713},
{8916,324},
{8700,2771},
{9257,8411},
{4131,1546},
{6226,5906},
{8899,9586},
{4419,2311},
{8583,309},
{4388,9001},
{2798,2436},
{7689,2024},
{6141,3650},
{3742,4976},
{5155,9688},
{3001,3224},
{5121,7470},
{8377,7020},
{7960,7044},
{8889,4149},
{4604,3313},
{6799,1943},
{1355,3715},
{5567,3994},
{3099,2989},
{3370,6209},
{7204,7672},
{9670,4891},
{3019,4377},
{9199,882},
{2085,6156},
{2465,7857},
{4808,4807},
{4007,7755},
{4177,8155},
{308,2256},
{7042,9062},
{5152,9069},
{1053,2539},
{3515,5080},
{8492,6751},
{2972,9691},
{9924,7776},
{7590,1257},
{1864,1367},
{6600,6795},
{2965,1896},
{2932,137},
{7083,7631},
{9834,311},
{6752,1832},
{9630,3712},
{8970,5712},
{8446,5770},
{8374,971},
{9910,5919},
{3542,2255},
{7344,5436},
{1670,6788},
{2270,1956},
{7041,3125},
{139,1989},
{8438,2083},
{2922,941},
{7134,930},
{1312,4255},
{7058,1978},
{9457,9126},
{5400,8771},
{9129,1177},
{7208,2745},
{4179,4639},
{8072,7201},
{8642,8437},
{7056,8796},
{5986,7086},
{2246,4015},
{7981,4824},
{6329,8389},
{7470,231},
{6593,5885},
{2546,4247},
{8546,2389},
{9910,307},
{1754,7400},
{2722,7034},
{6836,3405},
{4975,8781},
{7086,8990},
{7023,486},
{3740,3450},
{6884,2383},
{3423,7164},
{9607,3523},
{9901,2082},
{248,7815},
{1238,6682},
{5909,8774},
{7883,4527},
{4097,9035},
{2067,8402},
{2534,5032},
{6241,4396},
{3360,9709},
{818,8935},
{2389,2788},
{6193,7546},
{3122,734},
{7569,5393},
{3541,6649},
{501,2075},
{7089,6772},
{502,6948},
{3131,1521},
{5418,3613},
{3211,1901},
{1329,9797},
{4892,2788},
{2383,9815},
{6333,1896},
{2891,2245},
{7425,1992},
{8672,255},
{5055,3321},
{383,7434},
{9328,9553},
{475,6999},
{7141,8967},
{1617,6972},
{9746,1666},
{8162,3048},
{6457,4385},
{6273,7508},
{610,6844},
{6363,716},
{2598,2617},
{5386,506},
{0,8925},
{3793,4945},
{9056,2533},
{7162,1446},
{1320,7385},
{6409,7022},
{3883,9545},
{1866,844},
{2990,8483},
{519,1718},
{1474,8942},
{592,5330},
{8336,1419},
{9493,8149},
{8817,9191},
{9402,6381},
{3728,5286},
{1444,7387},
{130,2637},
{2137,9154},
{7092,1840},
{5952,6773},
{6505,5007},
{8996,2319},
{1928,8723},
{7647,599},
{44,9136},
{2276,7262},
{7259,119},
{4911,8973},
{2560,231},
{3142,4756},
{4484,748},
{8063,1816},
{4100,1096},
{6474,8536},
{9846,9052},
{1954,6375},
{2361,5343},
{8155,5916},
{8018,3088},
{6017,2793},
{2574,149},
{6575,5189},
{4237,1496},
{6195,2269},
{7112,4266},
{3960,936},
{7705,9844},
{3222,4732},
{9118,283},
{8442,9467},
{9337,2655},
{5043,721},
{6531,8274},
{9634,8342},
{9340,5953},
{8642,1679},
{6780,3729},
{6658,7583},
{8902,1436},
{5093,2424},
{9123,430},
{1505,8895},
{236,1647},
{8502,2253},
{2543,8939},
{9665,2376},
{8744,9597},
{203,6431},
{6257,570},
{6151,2568},
{7423,8072},
{5807,5335},
{939,7761},
{6316,9553},
{5710,8616},
{8261,709},
{1692,7984},
{440,9979},
{9846,5614},
{8335,5159},
{7633,5229},
{9290,5436},
{8500,9019},
{1582,614},
{7115,3991},
{9192,8082},
{8076,8861},
{4621,7253},
{5804,4322},
{2387,7921},
{589,9534},
{2935,9560},
{1488,2962},
{8738,9562},
{770,5328},
{8756,3660},
{2968,7346},
{6518,8813},
{9743,9248},
{1594,1541},
{2799,5549},
{724,2835},
{110,8715},
{508,4656},
{8422,9232},
{3408,3532},
{2582,1817},
{1343,2866},
{3757,7292},
{5829,3156},
{6896,6855},
{6901,4998},
{6010,5264},
{4727,3411},
{1667,9666},
{4226,8444},
{1817,1828},
{7132,949},
{3839,1581},
{3611,8613},
{2396,185},
{363,6736},
{7251,8563},
{9238,9488},
{2706,2682},
{1681,7408},
{6250,8008},
{489,7579},
{2010,9983},
{5488,5493},
{2570,7646},
{3946,5492},
{245,2192},
{2530,2126},
{7144,6030},
{1827,8332},
{7159,2474},
{8638,995},
{6332,5155},
{911,9456},
{2895,6817},
{290,8899},
{7230,7672},
{2694,5299},
{8039,2805},
{360,7958},
{1906,4650},
{8094,1728},
{2217,297},
{4653,4269},
{3217,8892},
{8443,716},
{2043,4262},
{2290,8976},
{9410,6523},
{5154,5239},
{6029,7411},
{7043,1220},
{3407,2829},
{6609,188},
{7075,3732},
{1604,8398},
{5020,4783},
{657,2454},
{9951,8505},
{3713,351},
{5835,6514},
{9404,1331},
{7700,1827},
{2643,7610},
{8631,8943},
{3975,4086},
{6401,4735},
{2022,1131},
{668,6595},
{4066,3735},
{894,7920},
{2137,4898},
{2260,7867},
{7720,1123},
{6068,7065},
{7695,4821},
{8323,20},
{7565,7893},
{3786,8905},
{7439,5612},
{9760,5525},
{7188,491},
{3100,1352},
{2239,5621},
{4214,9652},
{8374,9314},
{9149,723},
{5198,1735},
{6474,5209},
{493,9149},
{1569,8746},
{6649,3592},
{9352,7641},
{4614,1831},
{169,1417},
{2,4535},
{2573,2548},
{559,6160},
{2562,7524},
{1291,7690},
{2149,4107},
{1052,5930},
{7744,9747},
{348,3880},
{5007,7719},
{2140,3852},
{8424,122},
{3697,5412},
{1309,3388},
{1709,514},
{5330,4441},
{3814,4842},
{9351,8019},
{8439,3790},
{1904,5594},
{4804,4676},
{6937,6758},
{1376,9604},
{6641,8008},
{7653,7007},
{8690,3857},
{6187,5757},
{563,810},
{1925,6314},
{2694,2856},
{8479,2224},
{6460,7949},
{3602,3272},
{14,3752},
{2969,6909},
{9778,9218},
{9701,6265},
{237,8967},
{7599,2994},
{5689,3781},
{1952,9058},
{7049,5658},
{2429,6858},
{4711,5404},
{241,8045},
{5902,7389},
{7764,588},
{400,9279},
{2062,8420},
{2529,7726},
{5161,8805},
{1914,4524},
{7337,1755},
{2252,3002},
{7111,7493},
{3361,4131},
{5378,3682},
{1541,9290},
{713,9761},
{5450,1272},
{6282,2196},
{3169,8700},
{3494,3638},
{6744,730},
{4240,3799},
{7516,2708},
{801,577},
{6928,1648},
{6951,9921},
{4688,1928},
{5125,2163},
{5873,6723},
{5208,6871},
{1376,5790},
{8209,2053},
{7631,3476},
{4512,1997},
{1588,9803},
{6920,1694},
{8694,8482},
{375,8448},
{3455,6047},
{810,3638},
{1228,1344},
{4848,3031},
{1271,8195},
{2937,1435},
{7087,8367},
{1031,5443},
{6452,9445},
{6207,1926},
{5742,8741},
{9639,3046},
{1200,1410},
{1414,5877},
{5603,5424},
{220,743},
{9617,6948},
{3170,4051},
{6538,9772},
{3310,8698},
{989,640},
{3974,9681},
{230,5967},
{1584,786},
{3957,6936},
{3152,7825},
{4544,3963},
{7535,2679},
{7677,2398},
{8242,7015},
{3602,230},
{3720,7649},
{3684,3981},
{6544,5184},
{3102,4130},
{7933,8422},
{6248,3054},
{8278,834},
{4085,8986},
{175,1570},
{6609,6890},
{8695,111},
{6119,2816},
{8414,4948},
{4801,6258},
{2811,1482},
{2805,9877},
{389,8085},
{80,69},
{1876,7035},
{3855,3318},
{611,880},
{6316,527},
{4989,8351},
{3574,3759},
{829,6827},
{8922,6352},
{705,8279},
{8049,2298},
{6694,5622},
{241,6574},
{7725,9250},
{978,8876},
{6159,2210},
{7129,5496},
{2977,4434},
{5254,1818},
{5788,615},
{3661,5174},
{606,7276},
{4054,7108},
{5134,6107},
{1963,1240},
{891,503},
{6811,7686},
{3453,961},
{1338,1617},
{8563,5165},
{636,3725},
{4717,8790},
{1797,4682},
{1163,4895},
{5761,1874},
{7551,1846},
{8705,5862},
{8892,4659},
{578,409},
{359,2445},
{3419,1132},
{1638,7513},
{5078,2856},
{3069,4395},
{4520,4036},
{4570,1295},
{1873,9267},
{8219,5624},
{6959,7683},
{1371,8018},
{6603,6972},
{4792,5559},
{3583,4931},
{4617,7955},
{7833,6904},
{8719,1781},
{4517,4238},
{4084,1862},
{624,2478},
{804,9855},
{3389,7472},
{9226,3870},
{5231,6403},
{2371,4831},
{3079,6437},
{8632,4714},
{141,2752},
{4642,7962},
{4913,9929},
{9333,1174},
{8994,9955},
{4950,6440},
{3337,8479},
{9410,7443},
{9934,1331},
{3741,6640},
{2764,2594},
{7013,3494},
{2744,4814},
{4638,2847},
{4470,2018},
{9322,2972},
{3213,4454},
{4340,7334},
{6046,9684},
{8464,5361},
{2029,3320},
{2604,3411},
{1896,6214},
{4230,2510},
{5328,8714},
{1202,4334},
{8111,3744},
{8379,3504},
{4356,5804},
{6148,3855},
{5212,1234},
{6199,8118},
{5085,8447},
{8202,2162},
{5310,2187},
{4780,1138},
{8734,4721},
{5412,8280},
{9643,2703},
{8540,4947},
{4250,7032},
{6986,5598},
{2845,2440},
{6139,4850},
{8580,46},
{4480,1553},
{2692,8566},
{6202,6491},
{5451,5598},
{8686,5299},
{9044,3106},
{1821,1407},
{3940,7982},
{1145,3948},
{3842,1546},
{3706,3563},
{6758,1272},
{6845,9560},
{1707,556},
{2914,1063},
{6239,7816},
{7097,5127},
{1698,4064},
{1213,1836},
{7035,5822},
{6760,5404},
{1223,4335},
{7575,1643},
{7484,7843},
{2945,1747},
{2695,2743},
{4901,7912},
{9040,3208},
{6633,9046},
{4562,7954},
{7816,6491},
{1828,3360},
{2151,6612},
{1513,110},
{7053,5400},
{7568,7900},
{595,1474},
{7690,9332},
{1367,396},
{2180,9117},
{8390,7588},
{7785,3488},
{1758,3446},
{8068,9260},
{1407,6744},
{6878,5344},
{2011,8688},
{9451,2203},
{6054,9395},
{5898,9669},
{429,9335},
{9743,6935},
{9186,8186},
{7503,893},
{5221,3484},
{2444,2473},
{8719,1551},
{6841,8683},
{7781,1808},
{3775,2601},
{7253,1239},
{6343,2227},
{4314,1139},
{8532,4091},
{2620,7611},
{9559,1945},
{285,5076},
{3242,1418},
{7560,7293},
{2374,7557},
{6796,7592},
{8344,6233},
{3527,3693},
{7919,8480},
{6639,4479},
{9394,8626},
{7601,784},
{4308,4420},
{3812,9664},
{4636,7199},
{9726,4418},
{9394,2444},
{4872,3861},
{4634,3420},
{466,7765},
{3881,9164},
{2320,3878},
{3631,7577},
{4843,3263},
{5349,8044},
{540,7829},
{8846,3137},
{7241,7448},
{974,3991},
{4094,9755},
{4247,9707},
{1226,6828},
{8899,5973},
{3497,2815},
{4811,9688},
{212,6656},
{4206,4459},
{3563,9189},
{8519,542},
{4363,1103},
{4197,8773},
{193,7373},
{9560,9092},
{6114,5878},
{2291,1943},
{8686,343},
{4873,4263},
{4100,5104},
{2461,226},
{9209,5212},
{7208,5483},
{1993,613},
{2520,576},
{9610,5609},
{4455,3759},
{7997,3550},
{1103,4415},
{557,6907},
{8494,2586},
{9853,5122},
{7266,3623},
{9315,8003},
{975,9376},
{6454,1168},
{8722,3667},
{8187,2590},
{2632,4283},
{9244,1956},
{2014,3797},
{8426,9712},
{420,8698},
{7441,5283},
{6813,5656},
{2186,5820},
{1084,4654},
{5694,7732},
{1749,3398},
{9623,2278},
{7063,7341},
{9540,1344},
{7424,8591},
{9899,6719},
{1962,4729},
{5925,4601},
{8152,3938},
{7294,430},
{3791,5365},
{7486,2856},
{8842,7297},
{570,5322},
{4018,8126},
{936,1604},
{796,5573},
{6655,1117},
{2038,7984},
{4100,9120},
{4981,8686},
{2456,1800},
{3913,4651},
{828,8556},
{4004,414},
{6088,4452},
{6612,6905},
{1387,3112},
{8852,6086},
{6410,7830},
{4791,4999},
{9462,629},
{816,7078},
{681,2176},
{9296,6563},
{6955,4630},
{7107,4435},
{1910,1232},
{2388,8447},
{6655,7269},
{1396,4542},
{6570,3826},
{4636,8097},
{3109,8034},
{3140,2139},
{4692,4128},
{7650,7191},
{1824,4645},
{2393,2210},
{3734,4129},
{5328,5592},
{4321,891},
{4344,1476},
{6417,3722},
{9261,4457},
{8333,9152},
{7203,7522},
{5360,3770},
{7667,8685},
{7475,319},
{7150,3539},
{6021,338},
{8372,3966},
{6336,3857},
{501,2884},
{5499,6530},
{2354,9431},
{1590,3675},
{8680,5619},
{8091,7876},
{8306,5032},
{113,1550},
{2833,7912},
{6322,3734},
{9580,1312},
{7515,6162},
{9942,2382},
{7395,3816},
{91,9418},
{3843,884},
{420,9112},
{2659,2801},
{6299,5884},
{2097,6140},
{39,3494},
{9261,2438},
{5576,5758},
{4149,1279},
{8809,2527},
{5376,3458},
{9486,5245},
{8460,5423},
{548,2387},
{6392,5805},
{9760,5444},
{6893,492},
{2081,8688},
{3649,3790},
{190,4639},
{5077,9157},
{4501,1825},
};
    int** stone = NULL;
    int colSize = 2;
    int i, ret;
    stone = (int**)calloc(sizeof(tmpStone) / sizeof(tmpStone[0]), sizeof(int*));
    for (i = 0; i < sizeof(tmpStone) / sizeof(tmpStone[0]); i++) {
        stone[i] = (int*)calloc(2, sizeof(int*));
        memcpy(stone[i], tmpStone[i], 2 * sizeof(int));
    }
    /*qsort(stone, sizeof(tmpStone) / sizeof(tmpStone[0]), sizeof(int**), MyCmp);
    for (i = 0 ; i < sizeof(tmpStone) / sizeof(tmpStone[0]); i++) {
        printf("[%d,%d] \n", stone[i][0], stone[i][1]);
    }*/
    ret = removeStones(stone, sizeof(tmpStone) / sizeof(tmpStone[0]), &colSize);
    printf("%d\n", ret);
    for (i = 0; i < sizeof(tmpStone) / sizeof(tmpStone[0]); i++) {
        free(stone[i]);
        stone[i] = NULL;
    }
    free(stone);
    stone = NULL;
    return 0;
}
